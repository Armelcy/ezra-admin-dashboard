/**
 * Mock Action Center Data
 *
 * This file contains seed data for all action queues.
 * In production, this data would come from your database/API.
 */

import type { ActionItem, ActionNote } from '@/types/action-center';

// Helper to generate timestamps
const hoursAgo = (hours: number) => new Date(Date.now() - hours * 60 * 60 * 1000).toISOString();
const daysAgo = (days: number) => new Date(Date.now() - days * 24 * 60 * 60 * 1000).toISOString();
const hoursFromNow = (hours: number) => new Date(Date.now() + hours * 60 * 60 * 1000).toISOString();

// Helper to compute severity based on SLA
function computeSeverity(slaAt?: string): 'red' | 'amber' | 'green' {
  if (!slaAt) return 'green';
  const slaTime = new Date(slaAt).getTime();
  const now = Date.now();
  const hoursLeft = (slaTime - now) / (1000 * 60 * 60);

  if (hoursLeft < 2) return 'red';
  if (hoursLeft < 24) return 'amber';
  return 'green';
}

// KYC Items
export const kycItems: ActionItem[] = [
  {
    id: 'AC-KYC001',
    queue: 'kyc',
    refType: 'provider',
    refId: 'PRV-1234',
    title: 'Provider KYC verification required',
    whoName: 'Jean Dupont',
    whoPhone: '+237671234567',
    reasonCode: 'ID_MISMATCH',
    status: 'open',
    slaAt: hoursFromNow(1),
    severity: 'red' as const,
    openedAt: hoursAgo(47),
    updatedAt: hoursAgo(47),
    assigneeId: undefined,
    meta: {
      documents: ['national_id', 'selfie'],
      issue: 'Name on ID does not match profile name',
    },
  },
  {
    id: 'AC-KYC002',
    queue: 'kyc',
    refType: 'provider',
    refId: 'PRV-2345',
    title: 'Expired document uploaded',
    whoName: 'Marie Kamga',
    whoPhone: '+237677654321',
    reasonCode: 'DOC_EXPIRED',
    status: 'open',
    slaAt: hoursFromNow(12),
    severity: 'amber' as const,
    openedAt: hoursAgo(18),
    updatedAt: hoursAgo(18),
    assigneeId: 'admin-1',
    assigneeName: 'Operations Manager',
    meta: {
      expiryDate: '2024-12-01',
    },
  },
  {
    id: 'AC-KYC003',
    queue: 'kyc',
    refType: 'customer',
    refId: 'CUST-5678',
    title: 'Document image unclear',
    whoName: 'Paul Njike',
    whoPhone: '+237651111111',
    reasonCode: 'DOC_UNCLEAR',
    status: 'open',
    slaAt: hoursFromNow(36),
    severity: 'green' as const,
    openedAt: hoursAgo(6),
    updatedAt: hoursAgo(6),
    meta: {
      documents: ['national_id'],
      issue: 'Photo is too dark',
    },
  },
  {
    id: 'AC-KYC004',
    queue: 'kyc',
    refType: 'provider',
    refId: 'PRV-3456',
    title: 'Suspected fraud - multiple accounts',
    whoName: 'Thomas Bekono',
    whoPhone: '+237699222222',
    reasonCode: 'FRAUD_SUSPECTED',
    status: 'open',
    slaAt: hoursFromNow(2),
    severity: 'red' as const,
    openedAt: hoursAgo(46),
    updatedAt: hoursAgo(20),
    assigneeId: 'admin-1',
    assigneeName: 'Operations Manager',
    meta: {
      duplicateAccounts: ['PRV-1111', 'PRV-2222'],
    },
  },
  {
    id: 'AC-KYC005',
    queue: 'kyc',
    refType: 'provider',
    refId: 'PRV-4567',
    title: 'Incomplete KYC information',
    whoName: 'Sophie Ateba',
    whoPhone: '+237688333333',
    reasonCode: 'INFO_INCOMPLETE',
    status: 'snoozed',
    slaAt: hoursFromNow(72),
    severity: 'green' as const,
    openedAt: daysAgo(2),
    updatedAt: hoursAgo(4),
    meta: {
      missing: ['proof_of_address'],
    },
  },
];

// Booking Items
export const bookingItems: ActionItem[] = [
  {
    id: 'AC-BKG001',
    queue: 'bookings',
    refType: 'booking',
    refId: 'BK-2025-001',
    title: 'Provider needs to confirm booking',
    whoName: 'Alice Mbah (Provider)',
    whoPhone: '+237670444444',
    reasonCode: 'PENDING_CONFIRM',
    status: 'open',
    slaAt: hoursFromNow(3),
    severity: 'red' as const,
    amountAtRisk: 1500000, // 15,000 CFA in cents
    openedAt: hoursAgo(45),
    updatedAt: hoursAgo(45),
    meta: {
      customerName: 'John Nkeng',
      serviceName: 'Home Cleaning',
      scheduledFor: hoursFromNow(24),
    },
  },
  {
    id: 'AC-BKG002',
    queue: 'bookings',
    refType: 'booking',
    refId: 'BK-2025-002',
    title: 'Customer requesting reschedule',
    whoName: 'David Fouda (Customer)',
    whoPhone: '+237655555555',
    reasonCode: 'RESCHEDULE_REQUEST',
    status: 'open',
    slaAt: hoursFromNow(6),
    severity: 'amber' as const,
    amountAtRisk: 2500000,
    openedAt: hoursAgo(5),
    updatedAt: hoursAgo(5),
    assigneeId: 'admin-2',
    assigneeName: 'Support Admin',
    meta: {
      providerName: 'Marie Essomba',
      serviceName: 'Plumbing Repair',
      originalTime: hoursFromNow(12),
      requestedTime: hoursFromNow(48),
    },
  },
  {
    id: 'AC-BKG003',
    queue: 'bookings',
    refType: 'booking',
    refId: 'BK-2025-003',
    title: 'Cancellation request received',
    whoName: 'Emma Tagne (Customer)',
    whoPhone: '+237644444444',
    reasonCode: 'CANCELLATION_REQUEST',
    status: 'open',
    slaAt: hoursFromNow(8),
    severity: 'amber' as const,
    amountAtRisk: 1800000,
    openedAt: hoursAgo(3),
    updatedAt: hoursAgo(3),
    meta: {
      reason: 'Changed mind',
      cancellationPolicy: 'full_refund_24h',
    },
  },
  {
    id: 'AC-BKG004',
    queue: 'bookings',
    refType: 'booking',
    refId: 'BK-2025-004',
    title: 'Payment method declined',
    whoName: 'Frank Moukouri',
    whoPhone: '+237633333333',
    reasonCode: 'PAYMENT_ISSUE',
    status: 'open',
    slaAt: hoursFromNow(4),
    severity: 'red' as const,
    amountAtRisk: 3000000,
    openedAt: hoursAgo(8),
    updatedAt: hoursAgo(8),
    meta: {
      paymentMethod: 'mtn_momo',
      errorCode: 'INSUFFICIENT_FUNDS',
    },
  },
];

// Refunds & Disputes Items
export const refundsDisputesItems: ActionItem[] = [
  {
    id: 'AC-RFD001',
    queue: 'refunds_disputes',
    refType: 'booking',
    refId: 'BK-2025-100',
    title: 'Customer requesting full refund',
    whoName: 'Grace Ongola',
    whoPhone: '+237622222222',
    reasonCode: 'REFUND_REQUESTED',
    status: 'open',
    slaAt: hoursFromNow(6),
    severity: 'amber' as const,
    amountAtRisk: 5000000, // 50,000 CFA
    openedAt: hoursAgo(12),
    updatedAt: hoursAgo(12),
    meta: {
      reason: 'Service not satisfactory',
      providerName: 'Jean Service',
      serviceName: 'Electrical Work',
      bookingDate: daysAgo(2),
    },
  },
  {
    id: 'AC-RFD002',
    queue: 'refunds_disputes',
    refType: 'booking',
    refId: 'BK-2025-101',
    title: 'Chargeback opened by customer',
    whoName: 'Henry Bisseck',
    whoPhone: '+237611111111',
    reasonCode: 'CHARGEBACK_OPEN',
    status: 'open',
    slaAt: hoursFromNow(24),
    severity: 'green' as const,
    amountAtRisk: 7500000,
    openedAt: hoursAgo(6),
    updatedAt: hoursAgo(6),
    assigneeId: 'admin-3',
    assigneeName: 'Finance Manager',
    meta: {
      chargebackReason: 'Service not received',
      providerName: 'Marie Plumbing',
    },
  },
  {
    id: 'AC-RFD003',
    queue: 'refunds_disputes',
    refType: 'booking',
    refId: 'BK-2025-102',
    title: 'Provider did not show up',
    whoName: 'Isabelle Manga',
    whoPhone: '+237600000000',
    reasonCode: 'SERVICE_NOT_RENDERED',
    status: 'open',
    slaAt: hoursFromNow(2),
    severity: 'red' as const,
    amountAtRisk: 4000000,
    openedAt: hoursAgo(26),
    updatedAt: hoursAgo(26),
    meta: {
      providerName: 'Paul Electrical',
      scheduledFor: hoursAgo(28),
      evidence: ['customer_photo', 'chat_logs'],
    },
  },
  {
    id: 'AC-RFD004',
    queue: 'refunds_disputes',
    refType: 'booking',
    refId: 'BK-2025-103',
    title: 'Quality issue reported',
    whoName: 'Jacques Mbia',
    whoPhone: '+237699999999',
    reasonCode: 'QUALITY_ISSUE',
    status: 'open',
    slaAt: hoursFromNow(18),
    severity: 'amber' as const,
    amountAtRisk: 3500000,
    openedAt: hoursAgo(9),
    updatedAt: hoursAgo(9),
    meta: {
      issue: 'Work incomplete',
      providerName: 'Sophie Repairs',
      photos: ['before.jpg', 'after.jpg'],
    },
  },
  {
    id: 'AC-RFD005',
    queue: 'refunds_disputes',
    refType: 'booking',
    refId: 'BK-2025-104',
    title: 'Unauthorized charge dispute',
    whoName: 'Karine Ondoa',
    whoPhone: '+237688888888',
    reasonCode: 'UNAUTHORIZED_CHARGE',
    status: 'open',
    slaAt: hoursFromNow(4),
    severity: 'red' as const,
    amountAtRisk: 10000000,
    openedAt: hoursAgo(20),
    updatedAt: hoursAgo(20),
    assigneeId: 'admin-3',
    assigneeName: 'Finance Manager',
    meta: {
      originalAmount: 5000000,
      chargedAmount: 10000000,
      providerName: 'Thomas Services',
    },
  },
];

// Payout Items
export const payoutItems: ActionItem[] = [
  {
    id: 'AC-PAY001',
    queue: 'payouts',
    refType: 'payout',
    refId: 'PO-2025-001',
    title: 'Payout failed - bank details invalid',
    whoName: 'Lionel Onana',
    whoPhone: '+237677777777',
    reasonCode: 'BANK_DETAILS_INVALID',
    status: 'open',
    slaAt: hoursFromNow(8),
    severity: 'amber' as const,
    amountAtRisk: 15000000, // 150,000 CFA
    openedAt: hoursAgo(16),
    updatedAt: hoursAgo(16),
    meta: {
      payoutAmount: 15000000,
      paymentMethod: 'bank_transfer',
      errorMessage: 'Invalid account number',
    },
  },
  {
    id: 'AC-PAY002',
    queue: 'payouts',
    refType: 'payout',
    refId: 'PO-2025-002',
    title: 'Provider info needed for payout',
    whoName: 'Michelle Etame',
    whoPhone: '+237666666666',
    reasonCode: 'PENDING_INFO',
    status: 'open',
    slaAt: hoursFromNow(48),
    severity: 'green' as const,
    amountAtRisk: 8000000,
    openedAt: hoursAgo(4),
    updatedAt: hoursAgo(4),
    assigneeId: 'admin-3',
    assigneeName: 'Finance Manager',
    meta: {
      missing: ['tax_id', 'bank_statement'],
    },
  },
  {
    id: 'AC-PAY003',
    queue: 'payouts',
    refType: 'payout',
    refId: 'PO-2025-003',
    title: 'Automatic payout failed - retry needed',
    whoName: 'Nicolas Ebah',
    whoPhone: '+237655555555',
    reasonCode: 'FAILED_PAYOUT',
    status: 'open',
    slaAt: hoursFromNow(6),
    severity: 'amber' as const,
    amountAtRisk: 20000000,
    openedAt: hoursAgo(10),
    updatedAt: hoursAgo(10),
    meta: {
      attempts: 2,
      paymentMethod: 'orange_money',
      lastError: 'Recipient account temporarily unavailable',
    },
  },
  {
    id: 'AC-PAY004',
    queue: 'payouts',
    refType: 'payout',
    refId: 'PO-2025-004',
    title: 'Threshold not met for payout',
    whoName: 'Olivia Kotto',
    whoPhone: '+237644444444',
    reasonCode: 'THRESHOLD_NOT_MET',
    status: 'snoozed',
    slaAt: hoursFromNow(120),
    severity: 'green' as const,
    amountAtRisk: 3500000,
    openedAt: daysAgo(1),
    updatedAt: hoursAgo(2),
    meta: {
      currentBalance: 3500000,
      minimumThreshold: 5000000,
    },
  },
  {
    id: 'AC-PAY005',
    queue: 'payouts',
    refType: 'payout',
    refId: 'PO-2025-005',
    title: 'Manual hold requested on payout',
    whoName: 'Patrick Etoundi',
    whoPhone: '+237633333333',
    reasonCode: 'HOLD_REQUESTED',
    status: 'open',
    slaAt: hoursFromNow(24),
    severity: 'green' as const,
    amountAtRisk: 12000000,
    openedAt: hoursAgo(8),
    updatedAt: hoursAgo(8),
    assigneeId: 'admin-3',
    assigneeName: 'Finance Manager',
    meta: {
      requestedBy: 'admin-1',
      reason: 'Pending dispute resolution',
    },
  },
];

// Webhook Items
export const webhookItems: ActionItem[] = [
  {
    id: 'AC-WHK001',
    queue: 'webhooks',
    refType: 'webhook',
    refId: 'WHK-2025-001',
    title: 'Webhook delivery failed - payment confirmation',
    whoName: 'MTN MoMo Integration',
    reasonCode: 'DELIVERY_FAILED',
    status: 'open',
    slaAt: hoursFromNow(1),
    severity: 'red' as const,
    openedAt: hoursAgo(4),
    updatedAt: hoursAgo(4),
    meta: {
      endpoint: 'https://api.partner.com/webhooks/payment',
      event: 'payment.completed',
      httpStatus: 503,
      attempts: 5,
    },
  },
  {
    id: 'AC-WHK002',
    queue: 'webhooks',
    refType: 'webhook',
    refId: 'WHK-2025-002',
    title: 'Rate limit exceeded on webhook endpoint',
    whoName: 'Orange Money Integration',
    reasonCode: 'RATE_LIMITED',
    status: 'open',
    slaAt: hoursFromNow(12),
    severity: 'amber' as const,
    openedAt: hoursAgo(2),
    updatedAt: hoursAgo(2),
    meta: {
      endpoint: 'https://api.partner.com/webhooks/refund',
      event: 'refund.processed',
      rateLimitReset: hoursFromNow(1),
    },
  },
  {
    id: 'AC-WHK003',
    queue: 'webhooks',
    refType: 'webhook',
    refId: 'WHK-2025-003',
    title: 'Authentication failed for webhook',
    whoName: 'Third-party Service',
    reasonCode: 'AUTH_FAILED',
    status: 'open',
    slaAt: hoursFromNow(6),
    severity: 'amber' as const,
    openedAt: hoursAgo(3),
    updatedAt: hoursAgo(3),
    assigneeId: 'admin-1',
    assigneeName: 'Operations Manager',
    meta: {
      endpoint: 'https://api.partner.com/webhooks/booking',
      event: 'booking.confirmed',
      httpStatus: 401,
      errorMessage: 'Invalid signature',
    },
  },
];

// Content Flags Items
export const contentFlagsItems: ActionItem[] = [
  {
    id: 'AC-CNT001',
    queue: 'content_flags',
    refType: 'review',
    refId: 'REV-2025-001',
    title: 'Review flagged as inappropriate',
    whoName: 'Anonymous Reporter',
    reasonCode: 'REVIEW_FLAGGED',
    status: 'open',
    slaAt: hoursFromNow(24),
    severity: 'green' as const,
    openedAt: hoursAgo(8),
    updatedAt: hoursAgo(8),
    meta: {
      reviewAuthor: 'Questionable User',
      reviewContent: 'This contains offensive language...',
      providerName: 'Reputable Provider',
      flagReason: 'offensive_language',
    },
  },
  {
    id: 'AC-CNT002',
    queue: 'content_flags',
    refType: 'provider',
    refId: 'PRV-9999',
    title: 'Inappropriate profile image uploaded',
    whoName: 'Robert Ngono',
    whoPhone: '+237622222222',
    reasonCode: 'IMAGE_INAPPROPRIATE',
    status: 'open',
    slaAt: hoursFromNow(4),
    severity: 'red' as const,
    openedAt: hoursAgo(18),
    updatedAt: hoursAgo(18),
    assigneeId: 'admin-4',
    assigneeName: 'Content Admin',
    meta: {
      imageUrl: '/uploads/profile/PRV-9999.jpg',
      reportCount: 3,
    },
  },
  {
    id: 'AC-CNT003',
    queue: 'content_flags',
    refType: 'provider',
    refId: 'PRV-8888',
    title: 'Suspicious profile activity detected',
    whoName: 'Sarah Tchuente',
    whoPhone: '+237611111111',
    reasonCode: 'PROFILE_SUSPICIOUS',
    status: 'open',
    slaAt: hoursFromNow(12),
    severity: 'amber' as const,
    openedAt: hoursAgo(5),
    updatedAt: hoursAgo(5),
    meta: {
      suspiciousActivity: ['rapid_profile_changes', 'fake_reviews_suspected'],
      accountAge: '2 days',
    },
  },
  {
    id: 'AC-CNT004',
    queue: 'content_flags',
    refType: 'review',
    refId: 'REV-2025-002',
    title: 'Spam detected in review',
    whoName: 'System Auto-Detection',
    reasonCode: 'SPAM_DETECTED',
    status: 'open',
    slaAt: hoursFromNow(36),
    severity: 'green' as const,
    openedAt: hoursAgo(2),
    updatedAt: hoursAgo(2),
    meta: {
      reviewContent: 'Check out my website for better deals...',
      spamScore: 0.95,
    },
  },
  {
    id: 'AC-CNT005',
    queue: 'content_flags',
    refType: 'customer',
    refId: 'CUST-7777',
    title: 'Harassment reported by provider',
    whoName: 'Theresa Bile',
    whoPhone: '+237600000000',
    reasonCode: 'HARASSMENT_REPORTED',
    status: 'open',
    slaAt: hoursFromNow(6),
    severity: 'amber' as const,
    openedAt: hoursAgo(14),
    updatedAt: hoursAgo(14),
    assigneeId: 'admin-4',
    assigneeName: 'Content Admin',
    meta: {
      reportedBy: 'PRV-5555',
      reportedByName: 'Vincent Nkoto',
      chatLogs: ['message1', 'message2'],
      incidentDescription: 'Threatening messages sent',
    },
  },
];

// All items combined
export const allActionItems: ActionItem[] = [
  ...kycItems,
  ...bookingItems,
  ...refundsDisputesItems,
  ...payoutItems,
  ...webhookItems,
  ...contentFlagsItems,
];

// Mock notes data
export const mockNotes: Record<string, ActionNote[]> = {
  'AC-KYC001': [
    {
      id: 'NOTE-001',
      actionItemId: 'AC-KYC001',
      body: 'Requested additional documentation from provider',
      authorId: 'admin-1',
      authorName: 'Operations Manager',
      createdAt: hoursAgo(24),
    },
    {
      id: 'NOTE-002',
      actionItemId: 'AC-KYC001',
      body: 'Provider uploaded new ID scan',
      authorId: 'system',
      authorName: 'System',
      createdAt: hoursAgo(12),
    },
  ],
  'AC-RFD001': [
    {
      id: 'NOTE-003',
      actionItemId: 'AC-RFD001',
      body: 'Contacted provider for their side of the story',
      authorId: 'admin-2',
      authorName: 'Support Admin',
      createdAt: hoursAgo(6),
    },
  ],
};
